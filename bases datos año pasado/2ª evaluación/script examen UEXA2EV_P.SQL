-- *********************************
-- ************ TABLAS EMPLE Y DEPART *********************
-- *********************************

DROP TABLE DEPART CASCADE CONSTRAINTS;

CREATE TABLE DEPART ( 
DEPT_NO NUMBER(2) NOT NULL PRIMARY KEY,
 DNOMBRE VARCHAR2(14 BYTE), 
LOC VARCHAR2(14 BYTE)
 ) ;


DROP TABLE EMPLE CASCADE CONSTRAINTS;

CREATE TABLE EMPLE ( 
  EMP_NO NUMBER(4) NOT NULL PRIMARY KEY, 
  APELLIDO VARCHAR2(10 BYTE), 
  OFICIO VARCHAR2(10 BYTE), 
  DIR NUMBER(4), 
  FECHA_ALT DATE, 
  SALARIO NUMBER(10), 
  COMISION NUMBER(10), 
  DEPT_NO NUMBER(2) , 
 CONSTRAINT emple_depart_fk FOREIGN KEY(DEPT_NO) REFERENCES DEPART(DEPT_NO) ON DELETE SET NULL
) ;


Insert into DEPART
   (DEPT_NO, DNOMBRE, LOC)
 Values
   (10, 'CONTABILIDAD', 'SEVILLA');
Insert into DEPART
   (DEPT_NO, DNOMBRE, LOC)
 Values
   (20, 'INVESTIGACION', 'MADRID');
Insert into DEPART
   (DEPT_NO, DNOMBRE, LOC)
 Values
   (30, 'VENTAS', 'BARCELONA');
Insert into DEPART
   (DEPT_NO, DNOMBRE, LOC)
 Values
   (40, 'PRODUCCION', 'BILBAO');
COMMIT;

Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7369, 'SANCHEZ', 'EMPLEADO', 7788, TO_DATE('12/17/1980 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1040, NULL, 20);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7499, 'ARROYO', 'VENDEDOR', 7698, TO_DATE('02/20/1980 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    2080, 390, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7521, 'SALA', 'VENDEDOR', 7698, TO_DATE('02/22/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1625, 650, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7566, 'JIMENEZ', 'DIRECTOR', 7839, TO_DATE('04/02/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    3867, NULL, 20);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7654, 'MARTIN', 'VENDEDOR', 7698, TO_DATE('09/29/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1625, 1820, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7698, 'NEGRO', 'DIRECTOR', 7839, TO_DATE('05/01/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    3705, NULL, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7782, 'CEREZO', 'DIRECTOR', 7839, TO_DATE('06/09/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    3185, NULL, 10);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7788, 'GIL', 'ANALISTA', 7566, TO_DATE('11/09/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    3900, NULL, 20);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7839, 'REY', 'PRESIDENTE', NULL, TO_DATE('11/17/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    6500, NULL, 10);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7844, 'TOVAR', 'VENDEDOR', 7698, TO_DATE('09/08/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1950, 0, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7876, 'ALONSO', 'EMPLEADO', 7788, TO_DATE('09/23/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1430, NULL, 20);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7900, 'JIMENO', 'EMPLEADO', 7698, TO_DATE('12/03/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1235, NULL, 30);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7902, 'FERNANDEZ', 'ANALISTA', 7566, TO_DATE('12/03/1981 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    3900, NULL, 20);
Insert into EMPLE
   (EMP_NO, APELLIDO, OFICIO, DIR, FECHA_ALT, 
    SALARIO, COMISION, DEPT_NO)
 Values
   (7934, 'MU—OZ', 'EMPLEADO', 7782, TO_DATE('01/23/1982 00:00:00', 'MM/DD/YYYY HH24:MI:SS'), 
    1690, NULL, 10);

ALTER TABLE EMPLE
ADD CONSTRAINT emple_emple_fk FOREIGN KEY(DIR) REFERENCES EMPLE(EMP_NO) ON DELETE SET NULL;

COMMIT;



-- *********************************
-- * TABLAS LIBROS, SOCIOS Y PR…STAMOS *********************
-- *********************************


DROP TABLE LIBROS CASCADE CONSTRAINTS; 
DROP TABLE SOCIOS CASCADE CONSTRAINTS; 
DROP TABLE PRESTAMOS CASCADE CONSTRAINTS; 

-- ************ CREACI‡N DE TABLAS: *********************

CREATE TABLE LIBROS
( COD_LIBRO VARCHAR2(10) PRIMARY KEY,
  TITULO VARCHAR2(50),
  AUTOR VARCHAR2(30),
  TEMA VARCHAR2(15),
  UNIDADES NUMBER(3)
) ;
-----------------------------------------------------------------

CREATE TABLE SOCIOS
( COD_SOCIO  NUMBER(6) PRIMARY KEY,
  NOMBRE VARCHAR2(30),
  DIRECCION VARCHAR2(30),
  PROVINCIA VARCHAR2(15),
  TLF NUMBER(9)
);

------------------------------------------------------------------
CREATE  TABLE PRESTAMOS
(
  COD_SOCIO NUMBER(6),
  COD_LIBRO VARCHAR2(10),
  FECHA_PRESTAMOS DATE, 
  CONSTRAINT PK_PRESTAMOS PRIMARY KEY(COD_SOCIO, COD_LIBRO),
  CONSTRAINT FK1_PRESTAMOS FOREIGN KEY(COD_LIBRO) REFERENCES LIBROS,
  CONSTRAINT FK2_PRESTAMOS FOREIGN KEY(COD_SOCIO) REFERENCES SOCIOS
);

-----------------------------------------------------------------
--------------- LLENAR LIBROS: -------------------------------
INSERT INTO LIBROS VALUES('IG-110','GUIA DE MICROSOFT WORKS 3','HARLEY HAHN','WORKS', 
6) ;
INSERT INTO LIBROS VALUES('IG-111','MICROSOFT WORKS 3','JOANNE WOODCOCK','WORKS',4);
INSERT INTO LIBROS VALUES('IG-112','MANUAL DE BORLAND C++ 4.0','ANGULO, JOSE MARIA', 
'LENGUAJE C',10);
INSERT INTO LIBROS VALUES('IG-113','MICROPROCESADORES 32 BITS','ANGULO, JOSE MARIA', 
'ARQUITECTURA',5);
INSERT INTO LIBROS VALUES('IG-114','COMPUTADORAS 5a GENERACION','BISHOP, PETER',  
'ARQUITECTURA', 6);
INSERT INTO LIBROS VALUES('IG-115','LIBRO DE EXCEL 97','JOHN WALKENBACH','EXCEL',7);
INSERT INTO LIBROS VALUES('IG-116','EXCEL 4 PARA WINDOWS-(99%)','SUSANA LINARES', 
'EXCEL', 10);
INSERT INTO LIBROS VALUES('IG-117','APLIQUE TURBO C++','SCHILDT H.','LENGUAJE C',4);
INSERT INTO LIBROS VALUES('IG-118','PROGRAMACION EN C++','ENRIQUE Y JOSE HERNANDEZ', 
'LENGUAJE C',6);
INSERT INTO LIBROS VALUES('IG-119','PUESTA A PUNTO DE ORACLE','ABBEY, J COREY', 
'ORACLE',5);
INSERT INTO LIBROS VALUES('IG-120','ORACLE 7. MANUAL DE REFERENCIA','GEORGE KOCH', 
'ORACLE',8);
INSERT INTO LIBROS VALUES('IG-121','ORACLE GUIA DE APRENDIZAJE 7','ABBEY, J COREY', 
'ORACLE',9);
INSERT INTO LIBROS VALUES('IG-122','TECNICAS DE PROGRAMACION','F. ALONSO', 
'PROGRAMACION',8);
INSERT INTO LIBROS VALUES('IG-123','METODOLOGIA DE LA PROGRAMACION','D. ALONSO Y S. 
RUMEU', 'PROGRAMACION',5);
INSERT INTO LIBROS VALUES('IG-124','PROGRAMACION ORIENTADA A OBJ','MORALES Y 
SEGOVIA', 'PROGRAMACION',7);



-----------------------------------------------------------
------------ LLENAR SOCIOS: ---------------------------
INSERT INTO SOCIOS VALUES(200,'JUAN MARTINEZ','LA ALAMEDA 15','MADRID',91667666);
INSERT INTO SOCIOS VALUES(210,'PEDRO PEREZ','LA HOSPEDERIA, 5','TOLEDO',45867666);
INSERT INTO SOCIOS VALUES(220,'ANA GARCIA','DEL HOSPITAL, 10','VALENCIA',96657666);
INSERT INTO SOCIOS VALUES(223,'JAVIER SANCHEZ','LOS BARRIOS S/N','TOLEDO',92567666);
INSERT INTO SOCIOS VALUES(226,'ALICIA MORALES','LA MARIPOSA 89','MADRID',91987666);
INSERT INTO SOCIOS VALUES(229,'JUANA LOPEZ','EL SALTAMONTES 315','MADRID',97167966);
INSERT INTO SOCIOS VALUES(230,'FRANCISCO PONCE','LA MARCHA, 21','MADRID',91445566);



-----------------------------------------------------------
------------ LLENAR PRESTAMOS: ---------------------------
-- SE CAMBIA LA FECHA PARA ALMACENAR EL A—O CORRECTAMENTE
ALTER SESSION SET NLS_DATE_FORMAT = 'DD/MM/YYYY';

INSERT INTO PRESTAMOS VALUES(200,'IG-114','10/02/2012');
INSERT INTO PRESTAMOS VALUES(200,'IG-117','16/02/2012');
INSERT INTO PRESTAMOS VALUES(200,'IG-119','17/02/2012');

INSERT INTO PRESTAMOS VALUES(210,'IG-115','8/02/2012');
INSERT INTO PRESTAMOS VALUES(210,'IG-117','10/02/2012');
INSERT INTO PRESTAMOS VALUES(210,'IG-120','12/02/2012');
INSERT INTO PRESTAMOS VALUES(210,'IG-121','12/02/2012');

INSERT INTO PRESTAMOS VALUES(223,'IG-116','15/02/2012');
INSERT INTO PRESTAMOS VALUES(223,'IG-117','17/02/2012');

INSERT INTO PRESTAMOS VALUES(226,'IG-114','13/02/2012');
INSERT INTO PRESTAMOS VALUES(226,'IG-115','15/02/2012');

INSERT INTO PRESTAMOS VALUES(229,'IG-115','17/02/2012');
INSERT INTO PRESTAMOS VALUES(229,'IG-120','18/02/2012');
INSERT INTO PRESTAMOS VALUES(229,'IG-122','18/02/2012');

INSERT INTO PRESTAMOS VALUES(230,'IG-114','10/02/2012');
INSERT INTO PRESTAMOS VALUES(230,'IG-118','17/02/2012');
INSERT INTO PRESTAMOS VALUES(230,'IG-119','19/02/2012');
INSERT INTO PRESTAMOS VALUES(230,'IG-123','20/02/2012');

Commit;

